Manage user events  |  Vertex AI Search for commerce  |  Google Cloud
Skip to main content
Technology areas
close
AI and ML
Application development
Application hosting
Compute
Data analytics and pipelines
Databases
Distributed, hybrid, and multicloud
Generative AI
Industry solutions
Networking
Observability and monitoring
Security
Storage
Cross-product tools
close
Access and resources management
Costs and usage management
Infrastructure as code
Migration
SDK, languages, frameworks, and tools
Related sites
close
Google Cloud Home
Free Trial and Free Tier
Architecture Center
Blog
Contact Sales
Google Cloud Developer Center
Google Developer Center
Google Cloud Marketplace
Google Cloud Marketplace Documentation
Google Cloud Skills Boost
Google Cloud Solution Center
Google Cloud Support
Google Cloud Tech Youtube Channel
/
English
Deutsch
Español
Español – América Latina
Français
Indonesia
Italiano
Português
Português – Brasil
中文 – 简体
中文 – 繁體
日本語
한국어
Console
Sign in
Vertex AI Search for commerce
Guides
Reference
Support
Resources
Contact Us
Start free
Technology areas
More
Guides
Reference
Support
Resources
Cross-product tools
More
Related sites
More
Console
Contact Us
Start free
Discover
Product overview
What is Vertex AI search for commerce?
Features and capabilities
Global endpoints
Guided search
About facets for search
Conversational product filtering
Overview
User experience guide
Developer guide
Conversational Commerce agent
Overview
User experience guide
Developer guide
Tile navigation
Get started
How Vertex AI search for commerce works
Before you begin
Initial setup
Authenticate to Vertex AI search for commerce
Identity and access management (IAM)
Implement Vertex AI search for commerce
Quickstart tutorials
Interactive tutorials
Troubleshoot tutorial issues
Create personalized movie recommendations
Prepare your data for indexing
About catalogs and products
Product attributes
Attribution tokens
Entities
About user events
Send your search data
Import historical user events
Record real-time user events
Import autocomplete data for search
Import catalog information
Build your commerce UI
Implement user events
Autocomplete for search
Search as you type
Query expansion
About serving configs
About serving controls
Personalization
Create serving configs
Create serving controls
Filter and order results
Boost results
Deploy Vertex AI
Recommendations
Get recommendations
Filter recommendations
Use recommendations in emails
Search
Get search results
Data quality
Manage search results
Manage serving configs
Manage serving controls
Manage site-wide attribute controls
Manage catalog information
Manage user events
Models
About recommendation models
Create recommendation models
Using a pretrained LLM
Manage models
Supported world languages
Data insights
Export your data into BigQuery
Export commerce metrics to BigQuery
Measure performance
View analytics
Get dashboards that show key performance indicators
Generate sales forecasts from commerce data
Monitor and troubleshoot
Set up Cloud Monitoring alerts
About A/B experiments
Monitor and analyze A/B experiments
Monitor and troubleshoot
Audit logging information
Govern and maintain
Update inventory
Update local inventory
Data governance for commerce
AI and ML
Application development
Application hosting
Compute
Data analytics and pipelines
Databases
Distributed, hybrid, and multicloud
Generative AI
Industry solutions
Networking
Observability and monitoring
Security
Storage
Access and resources management
Costs and usage management
Infrastructure as code
Migration
SDK, languages, frameworks, and tools
Google Cloud Home
Free Trial and Free Tier
Architecture Center
Blog
Contact Sales
Google Cloud Developer Center
Google Developer Center
Google Cloud Marketplace
Google Cloud Marketplace Documentation
Google Cloud Skills Boost
Google Cloud Solution Center
Google Cloud Support
Google Cloud Tech Youtube Channel
Home
Documentation
Industry solutions
Vertex AI Search for commerce
Guides
Send feedback
Manage user events
This page describes how to view and delete user events. For information about
recording user events as they happen, see
Record real-time user events
. To import user event data from
past events, see
Import historical user events
.
Rejoin user events tutorial
This tutorial show how to rejoin user events by making a
POST
request to the
userEvents:rejoin
endpoint.
To follow step-by-step guidance for this task directly in the
  Cloud Shell Editor, click
Guide me
:
Guide me
Remove user events tutorial
This tutorial show how to purge user events.
To follow step-by-step guidance for this task directly in the
  Cloud Shell Editor, click
Guide me
:
Guide me
View aggregated user event information
View event integration metrics in the
Events
tab on the Search for commerce console
Data
page. This page shows all events written or imported in last year. Metrics can take up
  to 24 hours to appear after successful data ingestion.
Go to the Data page
Rejoin user events
You can rejoin user events by making a
POST
request to the
userEvents:rejoin
endpoint.
The rejoin operation joins specified events with the latest version of the
product catalog.
A user event is considered unjoined if the product it is associated with isn't
present in the catalog at the time that the user event is ingested. Unjoined
events lack detailed product information and are not as useful to training
models and serving results.
In addition to addressing unjoined events, the rejoin operation can be used to
correct events that have been joined with the wrong product catalog.
You must have the
Retail AI Admin
IAM role to call this method. A rejoin
operation can take hours or days to complete.
curl
Set
userEventRejoinScope
according to the types of events you're rejoining:
USER_EVENT_REJOIN_SCOPE_UNSPECIFIED
: Default. Trigger rejoin for both joined
and unjoined events.
JOINED_EVENTS
: Trigger rejoin for only joined events.
UNJOINED_EVENTS
: Trigger rejoin for only unjoined events.
The following example triggers a rejoin for only unjoined events:
curl
-X
POST
\
-H
"Authorization: Bearer
$(
gcloud
auth
application-default
print-access-token
)
"
\
-H
"Content-Type: application/json; charset=utf-8"
\
--data
"{
'userEventRejoinScope': 'UNJOINED_EVENTS'
}"
\
"https://retail.googleapis.com/v2/projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/userEvents:rejoin"
You should receive a response object that looks something like this:
{
"name"
:
"projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/
OPERATION_ID
"
}
You can check the status of the rejoin. Replace
OPERATION_ID
with the
ID of the operation ID returned by the rejoin method:
curl
-H
"Authorization: Bearer
$(
gcloud
auth
application-default
print-access-token
)
"
\
"https://retail.googleapis.com/v2/projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/
OPERATION_ID
"
When the operation completes, the operation status returns as
done
:
{
"name"
:
"projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/
OPERATION_ID
"
,
"done"
:
true,
"response"
:
{
"@type"
:
"type.googleapis.com/google.cloud.retail.v2.RejoinUserEventsResponse"
,
"rejoinedUserEventsCount"
:
"1"
}
}
Java
public
static
String
rejoinUserEvents
(
UserEventRejoinScope
scope
)
throws
IOException
,
InterruptedException
,
ExecutionException
{
UserEventServiceClient
userEventsClient
=
getUserEventServiceClient
();
RejoinUserEventsRequest
request
=
RejoinUserEventsRequest
.
newBuilder
()
.
setParent
(
DEFAULT_CATALOG_NAME
)
.
setUserEventRejoinScope
(
scope
)
.
build
();
String
operationName
=
userEventsClient
.
rejoinUserEventsAsync
(
request
).
getName
();
userEventsClient
.
shutdownNow
();
userEventsClient
.
awaitTermination
(
2
,
TimeUnit
.
SECONDS
);
return
operationName
;
}
Remove user events
Generally, you should leave user events in place after they have been recorded.
Purging events is not recommended.
An event purge can take up to several days to complete. If you plan to reset
user events entirely, consider creating a new project instead.
If you have user events that were not recorded properly and need to remove them,
you can do so using the
userEvents.purge
method.
Specify the events you want to remove by using a
filter string
. This
supports selectively deleting user events by filtering on the
eventTime
,
eventType
,
visitorID
, and
userID
fields.
Because you cannot undo the delete, test your filter string by conducting a dry
run before deleting user events. The
force
field is set to
false
by
default; this setting will return the number of events to be deleted without
actually deleting them. When you are ready to actually delete the user events,
set the
force
field to
true
.
curl
This example filters for a time range, which must use the
Zulu Time date format
.
The
force
field is set to
false
.
curl
-X
POST
\
-H
"Authorization: Bearer "
$(
gcloud
auth
application-default
print-access-token
)
""
\
-H
"Content-Type: application/json; charset=utf-8"
\
--data
'{
"filter":"eventTime > \"2019-12-23T18:25:43.511Z\" eventTime < \"2019-12-23T18:30:43.511Z\"",
"force":"false"
}'
\
"https://retail.googleapis.com/v2/projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/userEvents:purge"
You should receive a response object that looks something like this, where
purge-user-events-54321
is the operation ID:
{
"name"
:
"projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/purge-user-events-54321"
}
This example requests the operation status:
curl
-H
"Authorization: Bearer
$(
gcloud
auth
application-default
print-access-token
)
"
\
"https://retail.googleapis.com/v2/projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/
OPERATION_ID
"
Operation status example:
{
"name"
:
"projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/operations/
OPERATION_ID
"
,
"done"
:
true,
"response"
:
{
"@type"
:
"type.googleapis.com/google.cloud.retail.v2.PurgeUserEventsResponse"
,
"purgedEventsCount"
:
"1"
}
}
Setting the
force
field to
true
forces the delete to occur.
curl
-X
POST
\
-H
"Authorization: Bearer "
$(
gcloud
auth
application-default
print-access-token
)
""
\
-H
"Content-Type: application/json; charset=utf-8"
\
--data
'{
"filter":"eventTime > \"2019-12-23T18:25:43.511Z\" eventTime < \"2019-12-23T18:30:43.511Z\"",
"force":"true"
}'
\
"https://retail.googleapis.com/v2/projects/
PROJECT_ID
/locations/global/catalogs/default_catalog/userEvents:purge"
Java
public
static
String
purgeUserEvents
(
String
filter
)
throws
IOException
,
InterruptedException
,
ExecutionException
{
UserEventServiceClient
userEventsClient
=
getUserEventServiceClient
();
PurgeUserEventsRequest
request
=
PurgeUserEventsRequest
.
newBuilder
()
.
setParent
(
DEFAULT_CATALOG_NAME
)
.
setFilter
(
filter
)
.
setForce
(
true
)
.
build
();
String
operationName
=
userEventsClient
.
purgeUserEventsAsync
(
request
).
getName
();
userEventsClient
.
shutdownNow
();
userEventsClient
.
awaitTermination
(
2
,
TimeUnit
.
SECONDS
);
return
operationName
;
}
Use the user event filter
You can filter user events to be deleted.
The filter is a string that contains one or more of the following restrictions:
eventTime
Provides a timestamp to bound the events to be deleted. This filter can
be specified once or twice, with a greater-than (>) or less-than (<) symbol.
The bounded time must be a single, contiguous block.
eventType
Restrict the events to be deleted to a single event type.
visitorID
Restrict the events to be deleted to a single visitor ID.
userID
Restrict the events to be deleted to a single user ID.
Only user events that satisfy all of the restrictions are deleted.
To delete all user events of type
add-to-cart
that were logged
on or after February 1, 2019, you would provide the following filter string:
eventTime
>
"2019-02-01T00:00:00Z"
eventType
=
add-to-cart
Send feedback
Except as otherwise noted, the content of this page is licensed under the
Creative Commons Attribution 4.0 License
, and code samples are licensed under the
Apache 2.0 License
. For details, see the
Google Developers Site Policies
. Java is a registered trademark of Oracle and/or its affiliates.
Last updated 2025-10-24 UTC.
Why Google
Choosing Google Cloud
Trust and security
Modern Infrastructure Cloud
Multicloud
Global infrastructure
Customers and case studies
Analyst reports
Whitepapers
Products and pricing
See all products
See all solutions
Google Cloud for Startups
Google Cloud Marketplace
Google Cloud pricing
Contact sales
Support
Community forums
Support
Release Notes
System status
Resources
GitHub
Getting Started with Google Cloud
Google Cloud documentation
Code samples
Cloud Architecture Center
Training and Certification
Developer Center
Engage
Blog
Events
X (Twitter)
Google Cloud on YouTube
Google Cloud Tech on YouTube
Become a Partner
Google Cloud Affiliate Program
Press Corner
About Google
Privacy
Site terms
Google Cloud terms
Manage cookies
Our third decade of climate action: join us
Sign up for the Google Cloud newsletter
Subscribe
English
Deutsch
Español
Español – América Latina
Français
Indonesia
Italiano
Português
Português – Brasil
中文 – 简体
中文 – 繁體
日本語
한국어